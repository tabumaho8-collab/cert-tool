<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·å½¢3å· å®›åå°åˆ·</title>
    <style>
        /* --- å…¨ä½“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        body {
            display: none;
            /* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç”¨ */
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            gap: 20px;
            justify-content: center;
            min-height: 100vh;
        }

        /* --- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  --- */
        .editor-pane {
            width: 350px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .back-btn {
            display: inline-block;
            padding: 5px 10px;
            text-decoration: none;
            border-radius: var(--btn-radius);
            font-size: 12px;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }

        button.print-btn {
            width: 100%;
            padding: 12px;
            background-color: #d9534f;
            /* å°ç­’ã£ã½ã„è‰² */
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
        }

        button.print-btn:hover {
            background-color: #c9302c;
        }

        /* --- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ --- */
        .preview-pane {
            flex-grow: 1;
            display: flex;
            justify-content: center;
        }

        /* é•·å½¢3å·ã‚µã‚¤ã‚ºï¼š120mm x 235mm */
        #envelope {
            width: 120mm;
            height: 235mm;
            background: white;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            /* å°åˆ·ã‚ºãƒ¬ã‚’é˜²ããŸã‚ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
            padding: 20mm 10mm;
            box-sizing: border-box;
            color: #333;
        }

        /* --- å®›åã®ãƒ‡ã‚¶ã‚¤ãƒ³ --- */
        /* éƒµä¾¿ç•ªå·æ  */
        .zip-area {
            position: absolute;
            top: 15mm;
            left: 15mm;
            /* éƒµä¾¿ç•ªå·æ ã®ä½ç½®ã«åˆã‚ã›ã‚‹ãªã‚‰èª¿æ•´ */
            font-size: 22px;
            font-weight: bold;
            letter-spacing: 5px;
            font-family: "OCR-B", monospace, sans-serif;
            /* æ•°å­—ã‚’è¦‹ã‚„ã™ã */
        }

        .zip-mark {
            font-size: 14px;
            margin-right: 5px;
        }

        /* ä½æ‰€ */
        .address-area {
            margin-top: 40mm;
            margin-left: 5mm;
            margin-right: 5mm;
            font-size: 16px;
            line-height: 1.6;
            min-height: 60px;
        }

        /* å®›åï¼ˆä¼šç¤¾åãƒ»æ°åï¼‰ */
        .name-area {
            margin-top: 10mm;
            margin-left: 15mm;
            margin-right: 5mm;
        }

        .dest-company {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .dest-dept {
            font-size: 14px;
            margin-bottom: 10px;
        }

        .dest-name {
            font-size: 26px;
            font-weight: bold;
        }

        .honorific {
            font-size: 20px;
            margin-left: 10px;
        }

        /* --- å·®å‡ºäººï¼ˆè‡ªåˆ†ã®ä¼šç¤¾ï¼‰ --- */
        .sender-area {
            position: absolute;
            bottom: 20mm;
            left: 12mm;
            width: 90mm;
            border-top: 1px solid #ccc;
            padding-top: 5px;
            font-size: 12px;
            line-height: 1.4;
        }

        .sender-title {
            font-size: 10px;
            color: #777;
            margin-bottom: 2px;
        }

        .sender-name {
            font-weight: bold;
            font-size: 14px;
        }

        /* åˆ‡æ‰‹æ ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆç”»é¢ç¢ºèªç”¨ï¼‰ */
        .stamp-mark {
            position: absolute;
            top: 10mm;
            right: 10mm;
            width: 20mm;
            height: 24mm;
            border: 1px dashed #ddd;
            color: #ddd;
            text-align: center;
            line-height: 24mm;
            font-size: 10px;
        }

        /* --- å°åˆ·è¨­å®š --- */
        @media print {
            body {
                display: block !important;
                background: none;
                margin: 0;
                padding: 0;
            }

            .editor-pane {
                display: none;
            }

            .preview-pane {
                display: block;
            }

            /* ç”»é¢ä¸Šã®åˆ‡æ‰‹æ ãªã©ã¯æ¶ˆã™ */
            .stamp-mark {
                display: none;
            }

            #envelope {
                box-shadow: none;
                margin: 0;
                /* ãƒ—ãƒªãƒ³ã‚¿ã«ã‚ˆã£ã¦ã¯ä½™ç™½è¨­å®šãŒå¿…è¦ */
                page-break-after: always;
            }

            /* é•·å½¢3å·ã‚µã‚¤ã‚ºã‚’æŒ‡å®š */
            @page {
                size: 120mm 235mm;
                margin: 0;
            }
        }

        @media (max-width: 900px) {
            body {
                flex-direction: column;
                align-items: center;
            }

            .editor-pane {
                width: 100%;
                max-width: 500px;
            }
        }
    </style>
    <link rel="stylesheet" href="theme.css">
</head>

<body>

    <script src="lock.js"></script>
    <script src="settings.js"></script>
    <script>
        if (typeof checkAuth === 'function') checkAuth(); else document.body.style.display = "flex";
        window.addEventListener('load', function () {
            if (typeof applyCompanyData === 'function') applyCompanyData();
            update();
        });
    </script>

    <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="editor-pane">
        <a href="index.html" class="back-btn">â¬… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</a>

        <h2>é•·å½¢3å· å®›åå°åˆ·</h2>

        <h3>ãŠå±Šã‘å…ˆ</h3>
        <div class="form-group">
            <label>éƒµä¾¿ç•ªå·</label>
            <input type="text" id="iptZip" placeholder="100-0001" oninput="update()">
        </div>
        <div class="form-group">
            <label>ä½æ‰€</label>
            <textarea id="iptAddr" rows="3" placeholder="æ±äº¬éƒ½åƒä»£ç”°åŒºåƒä»£ç”°1-1" oninput="update()"></textarea>
        </div>
        <div class="form-group">
            <label>ä¼šç¤¾å</label>
            <input type="text" id="iptComp" placeholder="ã€‡ã€‡å•†äº‹æ ªå¼ä¼šç¤¾" oninput="update()">
        </div>
        <div class="form-group">
            <label>éƒ¨ç½²ãƒ»å½¹è·</label>
            <input type="text" id="iptDept" placeholder="å–¶æ¥­éƒ¨ éƒ¨é•·" oninput="update()">
        </div>
        <div class="form-group">
            <label>æ°å</label>
            <input type="text" id="iptName" placeholder="ç”°ä¸­ å¤ªéƒ" oninput="update()">
        </div>
        <div class="form-group">
            <label>æ•¬ç§°</label>
            <select id="iptHonor" onchange="update()">
                <option value="æ§˜">æ§˜ (å€‹äºº)</option>
                <option value="å¾¡ä¸­">å¾¡ä¸­ (ä¼šç¤¾å®›)</option>
                <option value="æ®¿">æ®¿</option>
                <option value="å…ˆç”Ÿ">å…ˆç”Ÿ</option>
                <option value="">(ãªã—)</option>
            </select>
        </div>

        <hr>

        <h3>å·®å‡ºäºº (è‡ªå‹•å…¥åŠ›)</h3>
        <div class="form-group">
            <label>ä¼šç¤¾å</label>
            <input type="text" id="iptIssuerName" oninput="update()">
        </div>
        <div class="form-group">
            <label>ä½æ‰€ãƒ»TEL</label>
            <textarea id="iptIssuerAddr" rows="3" oninput="update()"></textarea>
        </div>
        <div class="form-group">
            <label>æ‹…å½“è€…å</label>
            <input type="text" id="iptIssuerRep" oninput="update()">
        </div>

        <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ å°ç­’ã«å°åˆ·ã™ã‚‹</button>
        <p style="font-size:11px; color:#666; margin-top:5px;">â€»å°åˆ·æ™‚ã¯ç”¨ç´™ã‚µã‚¤ã‚ºã‚’ã€Œé•·å½¢3å·ã€ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <div class="preview-pane">
        <div id="envelope">
            <div class="stamp-mark">åˆ‡æ‰‹</div>

            <!-- éƒµä¾¿ç•ªå· -->
            <div class="zip-area">
                <span class="zip-mark">ã€’</span><span id="viewZip">000-0000</span>
            </div>

            <!-- ä½æ‰€ -->
            <div class="address-area" id="viewAddr"></div>

            <!-- å®›å -->
            <div class="name-area">
                <div class="dest-company" id="viewComp"></div>
                <div class="dest-dept" id="viewDept"></div>
                <div style="margin-top:10px;">
                    <span class="dest-name" id="viewName"></span>
                    <span class="honorific" id="viewHonor">æ§˜</span>
                </div>
            </div>

            <!-- å·®å‡ºäºº -->
            <div class="sender-area">
                <div class="sender-title">å·®å‡ºäºº</div>
                <div id="viewIssuerAddr" style="white-space: pre-wrap; margin-bottom:3px;"></div>
                <div class="sender-name" id="viewIssuerName"></div>
                <div style="font-size:12px; margin-top:2px;" id="viewIssuerRep"></div>
            </div>
        </div>
    </div>

    <script>
        function update() {
            document.getElementById('viewZip').innerText = document.getElementById('iptZip').value;
            document.getElementById('viewAddr').innerText = document.getElementById('iptAddr').value;
            document.getElementById('viewComp').innerText = document.getElementById('iptComp').value;
            document.getElementById('viewDept').innerText = document.getElementById('iptDept').value;
            document.getElementById('viewName').innerText = document.getElementById('iptName').value;
            document.getElementById('viewHonor').innerText = document.getElementById('iptHonor').value;

            // å·®å‡ºäººï¼ˆsettings.jsã‹ã‚‰è‡ªå‹•ã§å…¥ã£ãŸå€¤ã¾ãŸã¯æ‰‹å…¥åŠ›ï¼‰
            document.getElementById('viewIssuerName').innerText = document.getElementById('iptIssuerName').value;
            document.getElementById('viewIssuerAddr').innerText = document.getElementById('iptIssuerAddr').value;

            // æ‹…å½“è€…åãŒã‚ã‚Œã°è¡¨ç¤º
            const rep = document.getElementById('iptIssuerRep').value;
            document.getElementById('viewIssuerRep').innerText = rep ? rep : "";
        }
    </script>
    <script src="theme.js"></script>
</body>

</html>