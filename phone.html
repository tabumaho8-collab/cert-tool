<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Memo ğŸ’–</title>
    <!-- Google Fonts: ä¸¸ã‚´ã‚·ãƒƒã‚¯ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --main-pink: #ff9eb5;
            --light-pink: #fff0f5;
            --accent-blue: #a2d2ff;
            --text-color: #5d4037;
            --shadow: 3px 3px 0px rgba(255, 182, 193, 0.5);
        }

        body {
            font-family: "M PLUS Rounded 1c", sans-serif;
            background-color: #fff0f6;
            /* ã‹ã‚ã„ã„ãƒ‰ãƒƒãƒˆæŸ„ã®èƒŒæ™¯ */
            background-image: radial-gradient(#ffcdd2 20%, transparent 20%), radial-gradient(#ffcdd2 20%, transparent 20%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            color: var(--text-color);
        }
        
        .container {
            display: flex;
            gap: 25px;
            width: 100%;
            max-width: 950px;
        }
        
        /* --- ã‚¨ãƒ‡ã‚£ã‚¿ã‚¨ãƒªã‚¢ --- */
        .editor-pane {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 25px;
            border: 3px solid #fff;
            box-shadow: 0 10px 20px rgba(255, 105, 180, 0.15);
            position: relative;
        }

        /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ */
        .back-btn {
            display: inline-block;
            background-color: #b2ebf2;
            color: var(--text-color);
            padding: 6px 12px;
            text-decoration: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 2px 2px 0px #80deea;
            transition: transform 0.1s;
        }
        .back-btn:active { transform: translateY(2px); box-shadow: none; }
        
        h2 {
            color: #ff6b81;
            margin-top: 0;
            font-size: 22px;
            text-align: center;
            text-shadow: 1px 1px 0 #fff;
            border-bottom: 2px dashed #ff9eb5;
            padding-bottom: 10px;
        }

        .form-group { margin-bottom: 18px; }
        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 6px;
            color: #ff6b81;
        }
        .form-group label::before { content: "â™¥ "; color: #ff9eb5; }

        input, textarea {
            width: 100%;
            padding: 12px;
            box-sizing: border-box;
            border: 2px solid #ffdde1;
            border-radius: 15px;
            font-size: 14px;
            font-family: inherit;
            background: #fff;
            transition: 0.3s;
            color: var(--text-color);
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #ff9eb5;
            box-shadow: 0 0 0 3px rgba(255, 158, 181, 0.2);
        }

        /* --- ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‹ã‚ã„ã„ãƒ‡ã‚¶ã‚¤ãƒ³ --- */
        .check-group { display: flex; flex-direction: column; gap: 12px; }
        
        .check-item {
            border: 2px solid #ffe0e9;
            border-radius: 18px;
            padding: 12px;
            background: #fff;
            transition: 0.2s;
            cursor: pointer;
        }
        
        /* é¸æŠã•ã‚ŒãŸæ™‚ */
        .check-item:has(input:checked) {
            background: #fff0f5;
            border-color: #ff9eb5;
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(255, 182, 193, 0.2);
        }
        
        .check-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: bold;
            color: var(--text-color);
            cursor: pointer;
        }
        
        /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹è‡ªä½“ã®ã‚«ã‚¹ã‚¿ãƒ ï¼ˆã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ï¼‰ */
        input[type="checkbox"] {
            accent-color: #ff6b81;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* è¿½åŠ å…¥åŠ›ã‚¨ãƒªã‚¢ï¼ˆå¹ãå‡ºã—é¢¨ï¼‰ */
        .sub-input {
            margin-top: 10px;
            margin-left: 28px;
            display: none;
            position: relative;
        }
        .check-item:has(input:checked) .sub-input { display: block; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        
        @keyframes popIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- å³å´ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ --- */
        .preview-pane { width: 380px; display: flex; flex-direction: column; gap: 15px; }
        
        .result-container {
            background: #fff;
            padding: 10px;
            border-radius: 20px;
            /* ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ—é¢¨ã®è£…é£¾ */
            border-top: 8px solid rgba(255, 182, 193, 0.5);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .result-box {
            background: #fffcf0; /* ã‚¯ãƒªãƒ¼ãƒ è‰² */
            color: #5d4037;
            padding: 20px;
            border-radius: 10px;
            font-family: "M PLUS Rounded 1c", monospace;
            line-height: 1.7;
            white-space: pre-wrap;
            font-size: 13px;
            min-height: 300px;
            border: 2px dashed #e0e0e0; /* ã‚¹ãƒ†ãƒƒãƒé¢¨ */
        }
        
        /* ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ï¼ˆã‚­ãƒ©ã‚­ãƒ©ï¼‰ */
        .copy-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #ff9eb5, #ff6b81);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            font-family: inherit;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(255, 107, 129, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        .copy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(255, 107, 129, 0.6);
        }
        .copy-btn::after {
            content: "âœ¨";
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .reset-btn {
            background: #fff;
            border: 2px solid #eee;
            color: #aaa;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            float: right;
            font-weight: bold;
        }
        .reset-btn:hover { border-color: #ff9eb5; color: #ff6b81; }

        .helper-text { font-size: 11px; text-align: center; color: #ff6b81; font-weight: bold; }

        /* ã‚¹ãƒãƒ›å¯¾å¿œ */
        @media (max-width: 700px) { .container { flex-direction: column; } .preview-pane { width: 100%; } }
    </style>
</head>
<body>
    <script src="auth.js"></script>
    <script>if (typeof checkAuth === 'function') checkAuth(); else document.body.style.display="flex";</script>

    <div class="container">
        <div class="editor-pane">
            <a href="index.html" class="back-btn">â¬… ã‚‚ã©ã‚‹</a>
            <button class="reset-btn" onclick="resetForm()">ãƒªã‚»ãƒƒãƒˆ</button>
            <h2>ğŸ’– Phone Memo ğŸ’–</h2>

            <div class="form-group">
                <label>ãŠç›¸æ‰‹ (ä¼šç¤¾åãƒ»æ°å)</label>
                <input type="text" id="iptFrom" placeholder="ä¾‹ï¼šã€‡ã€‡å•†äº‹ ç”°ä¸­æ§˜" oninput="update()">
            </div>

            <div class="form-group">
                <label>ç¤¾å†…ã®èª°å®›ï¼Ÿ</label>
                <input type="text" id="iptTo" placeholder="ä¾‹ï¼šä½è—¤ã•ã‚“" oninput="update()">
            </div>

            <div class="form-group">
                <label>ã©ã†ã™ã‚‹ï¼Ÿ (è¤‡æ•°ãˆã‚‰ã¹ã‚‹ã‚ˆ)</label>
                <div class="check-group">
                    
                    <!-- 1. æŠ˜ã‚Šè¿”ã— -->
                    <div class="check-item">
                        <label class="check-label">
                            <input type="checkbox" id="chkCallback" onchange="update()">
                            ğŸ“ æŠ˜ã‚Šè¿”ã—é›»è©±ã—ã¦ã»ã—ã„
                        </label>
                        <div class="sub-input">
                            <input type="text" id="iptTel" placeholder="ç›¸æ‰‹ã®ç•ªå·: 03-0000-0000" oninput="update()">
                        </div>
                    </div>

                    <!-- 2. ã¾ãŸé›»è©±ã™ã‚‹ -->
                    <div class="check-item">
                        <label class="check-label">
                            <input type="checkbox" id="chkAgain" onchange="update()">
                            ğŸ” ã¾ãŸæ›ã‘ç›´ã™ãã†ã§ã™
                        </label>
                        <div class="sub-input">
                            <input type="text" id="iptTime" placeholder="ã„ã¤é ƒï¼Ÿ (ä¾‹: æœ¬æ—¥15æ™‚é ƒ)" oninput="update()">
                        </div>
                    </div>

                    <!-- 3. é›»è©±ã‚ã£ãŸã“ã¨ã ã‘ä¼ãˆã‚‹ -->
                    <div class="check-item">
                        <label class="check-label">
                            <input type="checkbox" id="chkReceived" onchange="update()">
                            ğŸ“± é›»è©±ãŒã‚ã£ãŸã“ã¨ã ã‘å ±å‘Š
                        </label>
                    </div>

                </div>
            </div>

            <div class="form-group">
                <label>ä¼è¨€ãƒ¡ãƒ¢ (ãã‚ã—ã)</label>
                <textarea id="iptMsg" rows="4" placeholder="ä¾‹ï¼šè¦‹ç©æ›¸ã®ä»¶ã«ã¤ã„ã¦ç¢ºèªã—ãŸã„ãã†ã§ã™ã€‚" oninput="update()"></textarea>
            </div>
            
            <div class="form-group">
                <label>é›»è©±ã¨ã£ãŸäºº (è‡ªåˆ†)</label>
                <input type="text" id="iptMe" placeholder="è‡ªåˆ†ã®åå‰" oninput="update()">
            </div>
        </div>

        <div class="preview-pane">
            <div class="result-container">
                <div class="result-box" id="resultText"></div>
            </div>
            <button class="copy-btn" onclick="copyToClipboard()">ã‚³ãƒ”ãƒ¼ã™ã‚‹ ğŸ’•</button>
            <p class="helper-text">â†‘ ã“ã‚Œã‚’æŠ¼ã—ã¦LINEã‚„Slackã«ãƒšã‚¿ãƒƒï¼</p>
        </div>
    </div>

    <script>
        function update() {
            const date = new Date();
            const timeStr = `${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;
            
            const to = document.getElementById('iptTo').value || "ã€‡ã€‡ã•ã‚“";
            const from = document.getElementById('iptFrom').value || "ãŠå®¢æ§˜";
            const me = document.getElementById('iptMe').value;
            const msg = document.getElementById('iptMsg').value;

            // --- ãƒ“ã‚¸ãƒã‚¹æ–‡æ›¸ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ (ä¸­èº«ã¯çœŸé¢ç›®) ---
            let text = `ã€é›»è©±ãƒ¡ãƒ¢ã€‘ ${timeStr} å—é›»\n`;
            text += `${to} æ®¿\n`;
            text += `--------------------------------\n`;
            text += `å…ˆã»ã©ã€\n`;
            text += `ã€ ${from} ã€‘ã‚ˆã‚ŠãŠé›»è©±ãŒã‚ã‚Šã¾ã—ãŸã€‚\n`;
            text += `\n`;

            let actions = [];
            
            if (document.getElementById('chkReceived').checked) {
                actions.push("ãƒ»ãŠé›»è©±ãŒã‚ã£ãŸæ—¨ã€ãŠä¼ãˆã—ã¾ã™ã€‚");
            }

            if (document.getElementById('chkCallback').checked) {
                const tel = document.getElementById('iptTel').value;
                let line = "ãƒ»æŠ˜ã‚Šè¿”ã—ãŠé›»è©±ã‚’ã„ãŸã ããŸã„ã¨ã®ã“ã¨ã§ã™ã€‚";
                if(tel) line += `\n  (é€£çµ¡å…ˆ: ${tel})`;
                actions.push(line);
            }

            if (document.getElementById('chkAgain').checked) {
                const time = document.getElementById('iptTime').value;
                let line = "ãƒ»ã¾ãŸæ”¹ã‚ã¾ã™ã¨ã®ã“ã¨ã§ã™ã€‚";
                if(time) line += `\n  (ç›®å®‰: ${time})`;
                actions.push(line);
            }

            if (actions.length > 0) {
                text += actions.join("\n\n");
                text += `\n\n`;
            }

            if (msg.trim() !== "") {
                text += `ã€ä¼è¨€ãƒ»è©³ç´°ã€‘\n`;
                text += `${msg}\n`;
                text += `\n`;
            } else if (actions.length === 0) {
                text += `(ç”¨ä»¶ã®å…¥åŠ›ã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™)\n\n`;
            }
            
            text += `--------------------------------\n`;
            text += `å—é›»: ${me}`;

            document.getElementById('resultText').innerText = text;
        }

        function copyToClipboard() {
            const text = document.getElementById('resultText').innerText;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('.copy-btn');
                const original = btn.innerHTML;
                btn.innerHTML = "ã‚³ãƒ”ãƒ¼å®Œäº†ã ã‚ˆï¼ğŸ‘Œ";
                btn.style.background = "linear-gradient(45deg, #43a047, #66bb6a)";
                setTimeout(() => {
                    btn.innerHTML = original;
                    btn.style.background = "linear-gradient(45deg, #ff9eb5, #ff6b81)";
                }, 2000);
            });
        }

        function resetForm() {
            document.querySelectorAll('input[type="text"], textarea').forEach(e => e.value = "");
            document.querySelectorAll('input[type="checkbox"]').forEach(e => e.checked = false);
            update();
        }

        update();
    </script>
</body>
</html>