<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã®ã—ç´™ä½œæˆãƒ„ãƒ¼ãƒ«</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Yuji+Syuku&display=swap" rel="stylesheet">

    <style>
        /* =========================================
           CSSå¤‰æ•° (ãƒ†ãƒ¼ãƒå®šç¾©) - index.htmlã¨ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ³ãƒˆã«
           ========================================= */
        :root {
            --section-line: 1px solid #b2bec3;
        }

        /* --- å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        body {
            display: none;
            /* èªè¨¼å‰éè¡¨ç¤º */
            font-family: var(--font-family);
            background-color: var(--bg-color);
            background-image: var(--bg-image);
            background-size: cover;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            color: var(--text-color);
            /* Flex layout for header + content */
            flex-direction: column;
        }

        body.theme-kawaii {
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        body.theme-dark {
            background-size: 40px 40px;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            background-color: var(--header-bg);
            color: var(--header-text);
            width: 100%;
            padding: 12px 25px;
            box-sizing: border-box;
            box-shadow: var(--header-shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            flex-shrink: 0;
            transition: 0.3s;
            backdrop-filter: blur(5px);
        }

        h1 {
            margin: 0;
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .header-btns {
            display: flex;
            gap: 10px;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.1);
            color: inherit;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
        }

        body.theme-dark .theme-btn {
            border-color: var(--accent-color);
            color: var(--accent-color);
            border-radius: 4px;
            box-shadow: 0 0 5px rgba(0, 229, 255, 0.4);
        }

        .theme-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .back-btn-header {
            background: rgba(128, 128, 128, 0.3);
            color: inherit;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
        }

        .back-btn-header:hover {
            background: rgba(128, 128, 128, 0.5);
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
        .main-container {
            display: flex;
            gap: 20px;
            padding: 20px;
            justify-content: center;
            flex-grow: 1;
            align-items: flex-start;
        }

        .editor-pane {
            width: 350px;
            background: var(--sidebar-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: var(--border-style);
            backdrop-filter: var(--backdrop-filter);
            height: fit-content;
            flex-shrink: 0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--text-color);
            opacity: 0.9;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: var(--btn-radius);
            font-size: 14px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        body.theme-dark .form-group input,
        body.theme-dark .form-group select {
            background: rgba(0, 0, 0, 0.5);
            color: #fff;
            border-color: var(--accent-color);
        }

        button.print-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--btn-radius);
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            transition: 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        button.print-btn:hover {
            background-color: var(--accent-hover);
            transform: translateY(-2px);
        }

        body.theme-dark button.print-btn {
            background-color: rgba(0, 229, 255, 0.1);
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
        }

        body.theme-dark button.print-btn:hover {
            background: var(--accent-color);
            color: #000;
            box-shadow: 0 0 15px var(--accent-color);
        }

        .back-btn {
            display: inline-block;
            background-color: #6c757d;
            color: white;
            padding: 5px 12px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: 0.2s;
        }

        .back-btn:hover {
            opacity: 0.8;
        }

        body.theme-dark .back-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
        }

        /* ãƒ•ã‚©ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆã‚¹ã‚¤ãƒƒãƒ */
        .font-switch {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            margin-top: 5px;
            cursor: pointer;
            color: var(--text-sub);
        }

        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */
        .preview-pane {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
            /* ç”»é¢ä¸­å¤®ã«é…ç½® */
        }

        /* ã®ã—ç´™ï¼ˆA4æ¨ªï¼‰ */
        #noshi-paper {
            width: 297mm;
            height: 210mm;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #000;
            transform-origin: top left;
            /* ãƒªã‚µã‚¤ã‚ºç”¨ */

            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ç­†æ–‡å­— */
            font-family: "Yuji Syuku", serif;
        }

        /* scale logic handled in js or just let overflow scroll. css zooming is tricky. let's just create a container that scales down if needed or scroll */

        /* æ¨™æº–ãƒ•ã‚©ãƒ³ãƒˆï¼ˆæ˜æœä½“ï¼‰ã‚¯ãƒ©ã‚¹ - æ­£ã—ã„å­—å½¢ã‚’å„ªå…ˆ */
        .std-font {
            font-family: "Yu Mincho", "YuMincho", "Hiragino Mincho ProN", serif !important;
        }

        /* è–„å¢¨ãƒ¢ãƒ¼ãƒ‰ */
        .usuzumi-mode {
            color: #666 !important;
        }

        /* --- æ°´å¼• (CSSæç”») --- */
        .mizuhiki-line {
            width: 100%;
            height: 4px;
            background: repeating-linear-gradient(to bottom, #d93025 0%, #d93025 33%, #fff 33%, #fff 66%, #d93025 66%, #d93025 100%);
            position: absolute;
            top: 50%;
            left: 0;
            z-index: 1;
        }

        .mizuhiki-knot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 60px;
            z-index: 2;
            background: white;
        }

        .knot-img {
            width: 100%;
            height: 100%;
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
        }

        /* --- ã®ã—é£¾ã‚Š (å³ä¸Š) --- */
        .noshi-icon {
            position: absolute;
            top: 20mm;
            right: 20mm;
            width: 30mm;
            height: 50mm;
            border: 1px solid #d93025;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #d93025;
            font-size: 24px;
            background: #fff;
        }

        .noshi-inner {
            border: 1px solid #d93025;
            width: 60%;
            height: 60%;
            transform: rotate(45deg);
            background: #d93025;
        }

        /* --- æ–‡å­—ã‚¨ãƒªã‚¢ --- */
        .text-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            pointer-events: none;
            /* å…¥åŠ›ã‚’é‚ªé­”ã—ãªã„ */
        }

        /* ç¸¦æ›¸ãã®é…ç½® */
        .text-area.vertical-mode .text-top {
            justify-content: center;
            /* æ¨ªæ–¹å‘(Cross axis)ã®ä¸­å¤® */
            align-items: flex-end;
            /* ç¸¦æ–¹å‘(Main axis)ã®ä¸‹å¯„ã›(Mizuhikiã«è¿‘ã„æ–¹) */
        }

        .text-area.vertical-mode .text-bottom {
            flex-direction: row-reverse;
            /* å³ã‹ã‚‰å·¦ã¸ï¼ˆä¼šç¤¾åãŒå³ã€ä»£è¡¨è€…åãŒå·¦ï¼‰ */
            justify-content: center;
            /* æ¨ªæ–¹å‘(Cross axis)ã®ä¸­å¤® */
            align-items: flex-start;
            /* ç¸¦æ–¹å‘(Main axis)ã®ä¸Šå¯„ã›(Mizuhikiã«è¿‘ã„æ–¹) */
            padding-top: 80px;
            /* æ°´å¼•ã¨ã®é–“éš”ã‚’åºƒã’ã‚‹ */
        }

        .text-top {
            flex: 1;
            display: flex;
            align-items: center;
            /* â˜… ä¸­å¤®å¯„ã› */
            justify-content: center;
            padding-bottom: 20px;
        }

        .text-bottom {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 50px;
            /* â˜… æ°´å¼•ã‹ã‚‰ã®è·é›¢ */
        }

        /* ç¸¦æ›¸ãæ™‚ã®ç‰¹åˆ¥é…ç½®ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§èª¿æ•´å¯èƒ½ã«ï¼‰ */
        .vertical-mode .text-bottom {
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
            align-items: flex-start;
            height: 100%;
            padding-top: var(--offset-y, 60px);
            /* â˜…ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å€¤ã‚’åæ˜  */
        }

        .vertical-mode .title-text,
        .vertical-mode .name-text,
        .vertical-mode .rep-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            margin: 0 10px;
            /* æ–‡å­—é–“éš”èª¿æ•´ */
        }

        .title-text {
            font-size: 70px;
            font-weight: bold;
            letter-spacing: 0.2em;
        }

        .name-text {
            font-size: 45px;
            letter-spacing: 0.1em;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        /* ç¸¦æ›¸ãæ™‚ã®ãƒãƒ¼ã‚¸ãƒ³èª¿æ•´ */
        .vertical-mode .name-text {
            margin-bottom: 0;
            margin-left: 10px;
            /* è¡Œé–“ */
        }

        .rep-text {
            font-size: 28px;
            letter-spacing: 0.05em;
        }

        /* ä½æ‰€ãƒ†ã‚­ã‚¹ãƒˆ */
        .addr-text {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .vertical-mode .addr-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            margin: 0 12px;
            font-size: 18px;
            display: flex;
            align-items: flex-start;
            white-space: nowrap;
            /* â˜… æ”¹è¡Œç¦æ­¢ */
        }

        .vertical-mode .name-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            margin: 0 15px;
            display: flex;
            align-items: flex-start;
            white-space: nowrap;
            /* â˜… æ”¹è¡Œç¦æ­¢ */
        }

        .vertical-mode .rep-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            margin: 0 10px;
            font-size: 24px;
            display: flex;
            align-items: flex-start;
            padding-top: 40px;
            white-space: nowrap;
            /* â˜… æ”¹è¡Œç¦æ­¢ */
        }

        /* æ¨ªæ›¸ãæ™‚ã®ä½™ç™½èª¿æ•´ (çµµã¨è¿‘ã„å•é¡Œã®è§£æ¶ˆ) */
        .text-area:not(.vertical-mode) .text-bottom {
            padding-top: 50px;
            /* æ°´å¼•/çµã³ç›®ã‹ã‚‰ã®è·é›¢ã‚’ç©ºã‘ã‚‹ */
        }

        @media print {
            body {
                display: block !important;
                background: none !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            header,
            .editor-pane {
                display: none !important;
            }

            .main-container {
                padding: 0 !important;
                margin: 0 !important;
                display: block !important;
            }

            #noshi-paper {
                box-shadow: none !important;
                margin: 0 !important;
                width: 297mm !important;
                height: 210mm !important;
                transform: none !important;
                position: relative !important;
                color: #000 !important;
                /* â˜…å°åˆ·æ™‚ã¯å¿…ãšé»’ */
                -webkit-print-color-adjust: exact;
            }

            .usuzumi-mode #noshi-paper,
            .usuzumi-mode .title-text,
            .usuzumi-mode .name-text,
            .usuzumi-mode .rep-text,
            .usuzumi-mode .addr-text {
                color: #666 !important;
                /* â˜…è–„å¢¨ã¯ã‚°ãƒ¬ãƒ¼ */
            }

            /* ç¢ºå®Ÿã«æ–‡å­—ã‚’å‡ºã™ãŸã‚ã®è¨­å®š */
            .title-text,
            .name-text,
            .rep-text,
            .addr-text {
                visibility: visible !important;
                opacity: 1 !important;
                color: inherit !important;
            }

            @page {
                margin: 0;
                size: A4 landscape;
            }
        }
    </style>
    <link rel="stylesheet" href="theme.css">
</head>

<body>
    <script src="lock.js"></script>
    <script src="settings.js"></script>
    <script>
        if (typeof checkAuth === 'function') checkAuth(); else document.body.style.display = "flex";
        window.addEventListener('load', function () {
            if (typeof applyCompanyData === 'function') applyCompanyData();
            const co = localStorage.getItem("my_tool_company_info");
            if (co) {
                const data = JSON.parse(co);
                document.getElementById('iptName').value = data.name || "";
                document.getElementById('iptRep').value = data.rep || "";
            }
            update();
        });
    </script>

    <header id="global-header">
        <h1><a href="index.html" style="text-decoration:none; color:inherit;">ç¤¾å†…ãƒ„ãƒ¼ãƒ«</a> <span
                style="font-size:14px; opacity:0.8; font-weight:normal;">/ ã®ã—ç´™ ä½œæˆ</span></h1>
        <div class="header-btns">
            <button onclick="toggleTheme()" id="themeBtn" class="theme-btn">ğŸ¨ ãƒ†ãƒ¼ãƒå¤‰æ›´</button>
        </div>
    </header>

    <div class="main-container">
        <div class="editor-pane">
            <a href="index.html" class="back-btn">â¬… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</a>

            <h2 style="margin-top:0; border-bottom:1px solid #ddd; padding-bottom:10px; color:var(--text-color);">ã®ã—ç´™è¨­å®š
            </h2>

            <div class="form-group">
                <label>è¡¨æ›¸ã (ä¸Šæ®µ)</label>
                <select id="selTitle" onchange="applyTitle()">
                    <option value="å¾¡ç¥">å¾¡ç¥</option>
                    <option value="å†…ç¥">å†…ç¥</option>
                    <option value="å¾¡ç¤¼">å¾¡ç¤¼</option>
                    <option value="ç²—å“" selected>ç²—å“</option>
                    <option value="å¾¡ä¸­å…ƒ">å¾¡ä¸­å…ƒ</option>
                    <option value="å¾¡æ­³æš®">å¾¡æ­³æš®</option>
                    <option value="å¿—">å¿— (è–„å¢¨ãƒ»ä»äº‹)</option>
                    <hr>
                    <option value="å¾¡è¦‹èˆ">å¾¡è¦‹èˆ (è–„å¢¨ãƒ»çµã³åˆ‡ã‚Š)</option>
                    <option value="å¾¡éœŠå‰">å¾¡éœŠå‰ (è–„å¢¨ãƒ»ä»äº‹)</option>
                    <option value="å¾¡ä»å‰">å¾¡ä»å‰ (è–„å¢¨ãƒ»ä»äº‹)</option>
                    <option value="">(è‡ªç”±å…¥åŠ›)</option>
                </select>
                <input type="text" id="iptTitle" value="ç²—å“" oninput="update()" style="margin-top:5px;"
                    placeholder="è‡ªç”±ã«å…¥åŠ›">
            </div>

            <div class="form-group">
                <label>æ–‡å­—ã®å‘ã</label>
                <div style="display:flex; gap:10px;">
                    <label style="font-weight:normal; cursor:pointer;"><input type="radio" name="direction" value="v"
                            checked onchange="toggleDirection()"> ç¸¦æ›¸ã (ä¼šç¤¾ãƒ»æ­£å¼)</label>
                    <label style="font-weight:normal; cursor:pointer;"><input type="radio" name="direction" value="h"
                            onchange="toggleDirection()"> æ¨ªæ›¸ã (ãƒ¢ãƒ€ãƒ³)</label>
                </div>
            </div>

            <div class="form-group">
                <label>ä½æ‰€ (å¿…è¦ãªå ´åˆ)</label>
                <input type="text" id="iptAddr" oninput="update()" placeholder="æ±äº¬éƒ½æ¸¯åŒº...">
            </div>

            <div class="form-group">
                <label>åå…¥ã‚Œ (ä¼šç¤¾åãªã©)</label>
                <input type="text" id="iptName" oninput="update()" placeholder="æ ªå¼ä¼šç¤¾ã€‡ã€‡">

                <div style="display:flex; align-items:center; gap:10px; margin-top:8px;">
                    <span style="font-size:11px; color:var(--text-sub); white-space:nowrap;">æ–‡å­—ã‚µã‚¤ã‚º</span>
                    <input type="range" id="rngFontSize" min="20" max="60" value="45" oninput="update()"
                        style="flex:1; cursor:pointer;" title="æ–‡å­—ã‚µã‚¤ã‚ºèª¿æ•´">
                </div>

                <!-- â–¼â–¼â–¼ ãƒ•ã‚©ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆã‚¹ã‚¤ãƒƒãƒ â–¼â–¼â–¼ -->
                <label class="font-switch">
                    <input type="checkbox" id="chkStdFont" onchange="toggleNameFont()">
                    ç­†æ–‡å­—ãŒå´©ã‚Œã‚‹å ´åˆ (æ¨™æº–ãƒ•ã‚©ãƒ³ãƒˆ)
                </label>
            </div>

            <div class="form-group">
                <label>ä»£è¡¨è€…å (å¿…è¦ãªå ´åˆ)</label>
                <input type="text" id="iptRep" oninput="update()" placeholder="ä»£è¡¨å–ç· å½¹ ã€‡ã€‡">
            </div>

            <!-- â–¼â–¼â–¼ ä½ç½®èª¿æ•´ç”¨ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ â–¼â–¼â–¼ -->
            <div class="form-group" style="background: rgba(0,0,0,0.05); padding: 10px; border-radius: 8px;">
                <label style="color: var(--accent-color);">åå‰ã®ä¸Šä¸‹ä½ç½®èª¿æ•´</label>
                <div style="display:flex; align-items:center; gap:10px;">
                    <span style="font-size:11px;">ä¸Š</span>
                    <input type="range" id="rngOffsetY" min="0" max="150" value="60" oninput="update()"
                        style="flex:1; cursor:pointer;">
                    <span style="font-size:11px;">ä¸‹</span>
                </div>
                <p style="font-size:10px; color:var(--text-sub); margin:5px 0 0 0;">â€»æ°´å¼•ï¼ˆä¸­å¤®ã®ç·šï¼‰ã«åˆã‚ã›ã¦èª¿æ•´ã—ã¦ãã ã•ã„</p>
            </div>

            <hr style="border:0; border-top:1px dashed #ccc; margin:15px 0;">
            <div class="form-group">
                <label>æ°´å¼•ã®ç¨®é¡</label>
                <select id="selMizuhiki" onchange="updateStyle()">
                    <option value="red_cho">ç´…ç™½ãƒ»è¶çµã³ (ä¸€èˆ¬ãƒ»ãŠç¥ã„)</option>
                    <option value="red_kiri">ç´…ç™½ãƒ»çµã³åˆ‡ã‚Š (ãŠè¦‹èˆã„ãƒ»å©šç¤¼)</option>
                    <option value="bw_kiri">é»’ç™½ãƒ»çµã³åˆ‡ã‚Š (ä»äº‹)</option>
                </select>
            </div>

            <div class="form-group">
                <label>å¢¨ã®è‰²</label>
                <select id="selInk" onchange="updateStyle()">
                    <option value="black">æ¿ƒå¢¨ (é€šå¸¸)</option>
                    <option value="gray">è–„å¢¨ (ãŠæ‚”ã‚„ã¿ãƒ»ãŠè¦‹èˆã„)</option>
                </select>
            </div>

            <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ å°åˆ·ã™ã‚‹</button>
        </div>

        <div class="preview-pane">
            <div id="noshi-paper">
                <div class="noshi-icon" id="noshiMark">
                    <div class="noshi-inner"></div>
                </div>
                <div class="mizuhiki-line" id="line"></div>
                <div class="mizuhiki-knot" id="knot">
                    <div class="knot-img" id="knotImg"></div>
                </div>

                <div class="text-area" id="textArea">
                    <div class="text-top">
                        <div class="title-text" id="viewTitle">ç²—å“</div>
                    </div>
                    <div class="text-bottom">
                        <div class="addr-text" id="viewAddr"></div>
                        <div class="name-text" id="viewName"></div>
                        <div class="rep-text" id="viewRep"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SVG_CHO = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60'%3E%3Cpath d='M10,10 Q30,50 50,30 Q70,50 90,10' fill='none' stroke='%23d93025' stroke-width='3'/%3E%3Cpath d='M10,20 Q30,60 50,40 Q70,60 90,20' fill='none' stroke='%23d93025' stroke-width='3'/%3E%3Cpath d='M50,10 L50,50' fill='none' stroke='%23d93025' stroke-width='3'/%3E%3C/svg%3E`;
        const SVG_KIRI_RED = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60'%3E%3Cpath d='M10,30 L90,30' fill='none' stroke='%23d93025' stroke-width='4'/%3E%3C/svg%3E`;
        const SVG_KIRI_BK = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60'%3E%3Cpath d='M10,30 L90,30' fill='none' stroke='%23333' stroke-width='4'/%3E%3C/svg%3E`;

        function applyTitle() {
            const val = document.getElementById('selTitle').value;
            const ipt = document.getElementById('iptTitle');
            const selMizuhiki = document.getElementById('selMizuhiki');
            const selInk = document.getElementById('selInk');

            if (val) ipt.value = val;

            if (val === "å¾¡è¦‹èˆ") {
                selMizuhiki.value = "red_kiri";
                selInk.value = "gray";
            } else if (val === "å¾¡éœŠå‰" || val === "å¾¡ä»å‰") {
                selMizuhiki.value = "bw_kiri";
                selInk.value = "gray";
            } else if (val === "å¾¡ç¥" || val === "å†…ç¥" || val === "ç²—å“") {
                selMizuhiki.value = "red_cho";
                selInk.value = "black";
            }
            update();
            updateStyle();
        }

        function update() {
            document.getElementById('viewTitle').innerText = document.getElementById('iptTitle').value;
            document.getElementById('viewAddr').innerText = document.getElementById('iptAddr').value;
            document.getElementById('viewName').innerText = document.getElementById('iptName').value;
            document.getElementById('viewRep').innerText = document.getElementById('iptRep').value;

            // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºé©ç”¨
            const size = document.getElementById('rngFontSize').value;
            document.getElementById('viewName').style.fontSize = size + "px";

            // ä¸Šä¸‹ä½ç½®ã‚ªãƒ•ã‚»ãƒƒãƒˆé©ç”¨
            const offsetY = document.getElementById('rngOffsetY').value;
            document.getElementById('textArea').style.setProperty('--offset-y', offsetY + 'px');
        }

        function toggleNameFont() {
            const isChecked = document.getElementById('chkStdFont').checked;
            const viewName = document.getElementById('viewName');
            const viewRep = document.getElementById('viewRep');
            const viewAddr = document.getElementById('viewAddr');

            if (isChecked) {
                viewName.classList.add('std-font');
                viewRep.classList.add('std-font');
                viewAddr.classList.add('std-font');
            } else {
                viewName.classList.remove('std-font');
                viewRep.classList.remove('std-font');
                viewAddr.classList.remove('std-font');
            }
        }

        function updateStyle() {
            const type = document.getElementById('selMizuhiki').value;
            const ink = document.getElementById('selInk').value;
            const line = document.getElementById('line');
            const knotImg = document.getElementById('knotImg');
            const noshiMark = document.getElementById('noshiMark');
            const paper = document.getElementById('noshi-paper');

            if (ink === 'gray') paper.classList.add('usuzumi-mode');
            else paper.classList.remove('usuzumi-mode');

            if (type === 'red_cho') {
                line.style.background = "repeating-linear-gradient(to bottom, #d93025 0%, #d93025 33%, #fff 33%, #fff 66%, #d93025 66%, #d93025 100%)";
                knotImg.style.backgroundImage = `url("${SVG_CHO}")`;
                noshiMark.style.display = "flex";
            } else if (type === 'red_kiri') {
                line.style.background = "repeating-linear-gradient(to bottom, #d93025 0%, #d93025 33%, #fff 33%, #fff 66%, #d93025 66%, #d93025 100%)";
                knotImg.style.backgroundImage = `url("${SVG_KIRI_RED}")`;
                noshiMark.style.display = "flex";
            } else {
                line.style.background = "repeating-linear-gradient(to bottom, #333 0%, #333 33%, #fff 33%, #fff 66%, #333 66%, #333 100%)";
                knotImg.style.backgroundImage = `url("${SVG_KIRI_BK}")`;
                noshiMark.style.display = "none";
            }
        }

        // ç¸¦æ›¸ããƒ»æ¨ªæ›¸ãåˆ‡ã‚Šæ›¿ãˆ
        function toggleDirection() {
            const rads = document.getElementsByName('direction');
            let val = 'v';
            for (const r of rads) { if (r.checked) val = r.value; }

            const area = document.getElementById('textArea');
            if (val === 'v') {
                area.classList.add('vertical-mode');
            } else {
                area.classList.remove('vertical-mode');
            }
        }

        // ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆãƒ»å…±é€šå‡¦ç† (index.htmlã‹ã‚‰ç§»æ¤)
        const THEMES = ['', 'theme-kawaii', 'theme-dark'];

        window.addEventListener('load', () => {
            // æ—¢å­˜ã®loadã‚¤ãƒ™ãƒ³ãƒˆå†…å‡¦ç†ã«è¿½åŠ 
            const savedTheme = localStorage.getItem('my_tool_theme');
            if (savedTheme && THEMES.includes(savedTheme)) {
                document.body.className = savedTheme;
            }
            updateBtnText();

            // åˆæœŸçŠ¶æ…‹ã®ç¸¦æ›¸ãé©ç”¨
            toggleDirection();
        });

        function toggleTheme() {
            const body = document.body;
            let currentClass = "";
            if (body.classList.contains('theme-kawaii')) currentClass = 'theme-kawaii';
            else if (body.classList.contains('theme-dark')) currentClass = 'theme-dark';

            const currentIndex = THEMES.indexOf(currentClass);
            const nextIndex = (currentIndex + 1) % THEMES.length;
            const nextClass = THEMES[nextIndex];

            body.className = nextClass;
            localStorage.setItem('my_tool_theme', nextClass);
            updateBtnText();
        }

        function updateBtnText() {
            const btn = document.getElementById('themeBtn');
            const body = document.body;
            if (!btn) return;

            if (body.classList.contains('theme-kawaii')) {
                btn.innerText = "ğŸ’– ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ (æ¬¡:Neon)";
                btn.style.color = "#fff";
                btn.style.borderColor = "#fff";
            } else if (body.classList.contains('theme-dark')) {
                btn.innerText = "âš¡ ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ (æ¬¡:Simple)";
                btn.style.color = "#00e5ff";
                btn.style.borderColor = "#00e5ff";
            } else {
                btn.innerText = "âœ¨ ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ (æ¬¡:Kawaii)";
                btn.style.color = "#fff";
                btn.style.borderColor = "rgba(255,255,255,0.5)";
            }
        }
    </script>
    <script src="theme.js"></script>
</body>

</html>