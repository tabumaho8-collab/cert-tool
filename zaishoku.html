<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨è·è¨¼æ˜æ›¸ä½œæˆãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            display: none;
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            gap: 20px;
            justify-content: center;
            min-height: 100vh;
        }

        .editor-pane {
            width: 350px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: fit-content;
        }

        /* â–¼â–¼â–¼ è¿½åŠ ï¼šæˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ â–¼â–¼â–¼ */
        .back-btn {
            display: inline-block;
            background-color: #6c757d;
            color: white;
            padding: 5px 10px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 15px;
            cursor: pointer;
        }
        .back-btn:hover { background-color: #5a6268; }
        /* â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–² */

        .editor-pane h2 { font-size: 18px; margin-bottom: 15px; border-bottom: 2px solid #ddd; padding-bottom: 5px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px; color: #555; }
        .form-group input, .form-group textarea {
            width: 100%; padding: 8px; box-sizing: border-box;
            border: 1px solid #ccc; border-radius: 4px; font-size: 14px;
        }
        button.print-btn {
            width: 100%; padding: 12px; background-color: #007bff;
            color: white; border: none; border-radius: 4px; font-size: 16px;
            cursor: pointer; font-weight: bold; margin-top: 10px;
        }
        button.print-btn:hover { background-color: #0056b3; }

        .preview-pane { flex-grow: 1; display: flex; justify-content: center; }
        
        #certificate {
            width: 210mm; min-height: 297mm; background: white; padding: 20mm;
            box-sizing: border-box; box-shadow: 0 5px 15px rgba(0,0,0,0.2); position: relative;
            font-family: "Yu Mincho", "YuMincho", "Hiragino Mincho ProN", "HGS Mincho E", serif; color: #000;
        }

        .cert-title {
            text-align: center; font-size: 32px; font-weight: bold;
            margin-bottom: 40px; letter-spacing: 5px; text-decoration: underline double;
        }
        .cert-date { text-align: right; margin-bottom: 30px; }
        .cert-body { margin-bottom: 40px; line-height: 2; }

        .cert-table { width: 100%; border-collapse: collapse; margin-bottom: 50px; border: 2px solid #333; }
        .cert-table th, .cert-table td { border: 1px solid #333; padding: 12px 15px; vertical-align: middle; }
        .cert-table th { width: 30%; background-color: #f9f9f9; text-align: left; font-weight: normal; }
        .cert-table td { width: 70%; font-weight: bold; font-size: 18px; }

        .cert-footer { margin-top: 50px; text-align: right; line-height: 1.6; }
        .company-name { font-size: 20px; font-weight: bold; margin-top: 10px; }
        .ceo-name { font-size: 18px; margin-top: 5px; }

        @media print {
            body { display: block !important; background: none; margin: 0; padding: 0; }
            .editor-pane { display: none; }
            .preview-pane { display: block; }
            #certificate { box-shadow: none; width: 100%; height: 100%; margin: 0; padding: 20mm; page-break-after: always; }
            @page { margin: 0; size: A4 portrait; }
        }
        @media (max-width: 900px) {
            body { flex-direction: column; align-items: center; }
            .editor-pane { width: 100%; max-width: 500px; }
            #certificate { width: 100%; font-size: 0.9em; padding: 10mm;}
        }
    </style>
</head>
<body>

    <script src="auth.js"></script>
    <script src="settings.js"></script>
    <script>
        if (typeof checkAuth === 'function') checkAuth(); else document.body.style.display = "flex";
        window.addEventListener('load', function() {
            if (typeof applyCompanyData === 'function') applyCompanyData();
        });
    </script>

    <div class="editor-pane">
        <!-- â–¼â–¼â–¼ æˆ»ã‚‹ãƒœã‚¿ãƒ³ â–¼â–¼â–¼ -->
        <a href="index.html" class="back-btn">â¬… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</a>

        <h2>å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ </h2>
        
        <div class="form-group"><label>è¨¼æ˜æ—¥ (ç™ºè¡Œæ—¥)</label><input type="date" id="issueDate"></div>
        <hr>
        <div class="form-group"><label>æ°å</label><input type="text" id="name" placeholder="å±±ç”° å¤ªéƒ"></div>
        <div class="form-group"><label>ç”Ÿå¹´æœˆæ—¥</label><input type="date" id="birthDate"></div>
        <div class="form-group"><label>ä½æ‰€</label><input type="text" id="address" placeholder="æ±äº¬éƒ½åƒä»£ç”°åŒº..."></div>
        <div class="form-group"><label>åœ¨è·æœŸé–“ (é–‹å§‹)</label><input type="date" id="periodStart"></div>
        <div class="form-group"><label>åœ¨è·æœŸé–“ (çµ‚äº†/ç¾åœ¨)</label><input type="text" id="periodEnd" placeholder="ç¾åœ¨ã«è‡³ã‚‹ã€ã¾ãŸã¯æ—¥ä»˜"></div>
        <div class="form-group"><label>æ‰€å±ãƒ»å½¹è·</label><input type="text" id="department" placeholder="å–¶æ¥­éƒ¨ èª²é•·"></div>
        <div class="form-group"><label>æ¥­å‹™å†…å®¹</label><textarea id="jobDesc" rows="2" placeholder="å–¶æ¥­æ´»å‹•ãŠã‚ˆã³ãƒãƒ¼ãƒ ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"></textarea></div>
        <hr>
        <div class="form-group"><label>ä¼šç¤¾ä½æ‰€</label><input type="text" id="compAddress" placeholder="æ±äº¬éƒ½æ¸¯åŒº..."></div>
        <div class="form-group"><label>ä¼šç¤¾å</label><input type="text" id="compName" placeholder="æ ªå¼ä¼šç¤¾ã€‡ã€‡"></div>
        <div class="form-group"><label>ä»£è¡¨è€…å</label><input type="text" id="compRep" placeholder="ä»£è¡¨å–ç· å½¹ ä½è—¤ æ¬¡éƒ"></div>

        <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ å°åˆ·ã™ã‚‹ / PDFä¿å­˜</button>
    </div>

    <div class="preview-pane">
        <div id="certificate">
            <div class="cert-title">åœ¨è·è¨¼æ˜æ›¸</div>
            <div class="cert-date"><span id="viewIssueDate">ä»¤å’Œã€‡å¹´ã€‡æœˆã€‡æ—¥</span></div>
            <div class="cert-body">ä¸‹è¨˜ã®è€…ã¯ã€å½“ç¤¾ã«åœ¨è·ã—ã¦ã„ã‚‹ï¼ˆã—ã¦ã„ãŸï¼‰ã“ã¨ã‚’è¨¼æ˜ã—ã¾ã™ã€‚</div>
            <table class="cert-table">
                <tr><th>æ° å</th><td id="viewName"></td></tr>
                <tr><th>ç”Ÿå¹´æœˆæ—¥</th><td id="viewBirthDate"></td></tr>
                <tr><th>ä½ æ‰€</th><td id="viewAddress"></td></tr>
                <tr><th>åœ¨è·æœŸé–“</th><td><span id="viewPeriodStart"></span> ã€œ <span id="viewPeriodEnd"></span></td></tr>
                <tr><th>æ‰€å±ãƒ»å½¹è·</th><td id="viewDepartment"></td></tr>
                <tr><th>æ¥­å‹™å†…å®¹</th><td id="viewJobDesc"></td></tr>
            </table>
            <div class="cert-footer">
                <div id="viewCompAddress"></div>
                <div class="company-name" id="viewCompName"></div>
                <div class="ceo-name" id="viewCompRep"></div>
                <div style="margin-top:20px; color:#ccc; font-size:12px;">(ç¤¾å°)</div>
            </div>
        </div>
    </div>

    <script>
        function formatDate(d){if(!d)return"";const D=new Date(d);return`${D.getFullYear()}å¹´${D.getMonth()+1}æœˆ${D.getDate()}æ—¥`}
        function updateCert(){
            document.getElementById('viewIssueDate').innerText=document.getElementById('issueDate').value?formatDate(document.getElementById('issueDate').value):"ä»¤å’Œã€€å¹´ã€€æœˆã€€æ—¥";
            document.getElementById('viewName').innerText=document.getElementById('name').value;
            document.getElementById('viewBirthDate').innerText=formatDate(document.getElementById('birthDate').value);
            document.getElementById('viewAddress').innerText=document.getElementById('address').value;
            document.getElementById('viewPeriodStart').innerText=formatDate(document.getElementById('periodStart').value);
            document.getElementById('viewPeriodEnd').innerText=document.getElementById('periodEnd').value;
            document.getElementById('viewDepartment').innerText=document.getElementById('department').value;
            document.getElementById('viewJobDesc').innerText=document.getElementById('jobDesc').value;
            document.getElementById('viewCompAddress').innerText=document.getElementById('compAddress').value;
            document.getElementById('viewCompName').innerText=document.getElementById('compName').value;
            document.getElementById('viewCompRep').innerText=document.getElementById('compRep').value;
        }
        document.querySelectorAll('input, textarea').forEach(i=>i.addEventListener('input',updateCert));
        document.getElementById('issueDate').valueAsDate=new Date();updateCert();
    </script>
</body>
</html>